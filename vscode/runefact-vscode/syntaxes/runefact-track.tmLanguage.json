{
  "scopeName": "source.runefact.track",
  "name": "Runefact Track",
  "patterns": [
    { "include": "#comments" },
    { "include": "#sections" },
    { "include": "#pattern-data" },
    { "include": "#strings" },
    { "include": "#keywords" },
    { "include": "#keys" },
    { "include": "#values" }
  ],
  "repository": {
    "comments": {
      "match": "#.*$",
      "name": "comment.line.number-sign.runefact"
    },
    "sections": {
      "match": "^\\s*(\\[\\[?[\\w.]+\\]\\]?)",
      "captures": {
        "1": { "name": "entity.name.section.runefact" }
      }
    },
    "pattern-data": {
      "begin": "(data)\\s*=\\s*\"\"\"",
      "end": "\"\"\"",
      "beginCaptures": {
        "1": { "name": "variable.other.key.runefact" }
      },
      "contentName": "string.unquoted.pattern-data.runefact",
      "patterns": [
        {
          "match": "\\b[A-G]#?\\d\\b",
          "name": "entity.name.note.runefact"
        },
        {
          "match": "---",
          "name": "comment.block.sustain.runefact"
        },
        {
          "match": "\\.\\.\\.",
          "name": "comment.line.silence.runefact"
        },
        {
          "match": "\\^\\^\\^",
          "name": "keyword.control.noteoff.runefact"
        },
        {
          "match": "[v><~a]\\d{1,3}",
          "name": "constant.other.effect.runefact"
        }
      ]
    },
    "strings": {
      "begin": "\"",
      "end": "\"",
      "name": "string.quoted.double.runefact"
    },
    "keywords": {
      "match": "\\b(tempo|ticks_per_beat|ticks|loop|loop_start|instrument|volume|name)\\b",
      "name": "keyword.other.runefact"
    },
    "keys": {
      "match": "^\\s*([\\w_]+)\\s*=",
      "captures": {
        "1": { "name": "variable.other.key.runefact" }
      }
    },
    "values": {
      "patterns": [
        {
          "match": "\\b(true|false)\\b",
          "name": "constant.language.boolean.runefact"
        },
        {
          "match": "\\b\\d+(\\.\\d+)?\\b",
          "name": "constant.numeric.runefact"
        }
      ]
    }
  }
}
